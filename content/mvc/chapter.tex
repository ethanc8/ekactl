\chapter{Multivariable Calculus}

\textbf{Colley (2012)} refers to \textit{Vector Calculus, Fourth Edition} by Susan Jane Colley.

\section{Vectors, lines, planes}

\subsection{$\Real^n$}

\begin{definition}[Two-dimensional real-coordinate space ($\Real^2$)] 
  \[
    \Real^2 = \{ (x, y) : x, y \in \Real \}
  \]
\end{definition}

\begin{definition}[Three-dimensional real-coordinate space ($\Real^2$)] 
  \[
    \Real^3 = \{ (x, y, z) : x, y, z \in \Real \}
  \]

  $x, y, z$ should be presented such that the coordinate system is right-handed ($\khat = \ihat \crossp \jhat$ should have direction according to the right-hand rule).
\end{definition}

\begin{definition}[Standard basis vectors] The standard basis vectors of a space are the unit vectors that go along the axes of the space. All vectors in that space can be expressed as sums of scalar multiples of the standard basis vectors of that space.

The standard basis vectors of $\Real^2$ are $\ihat$ and $\jhat$, also called $\mathbf{e_1}$ and $\mathbf{e_2}$.

The standard basis vectors of $\Real^3$ are $\ihat$, $\jhat$, and $\khat$, also called $\mathbf{e_1}$, $\mathbf{e_2}$, and $\mathbf{e_3}$.
\end{definition}

\subsection{Vectors}

See the properties of fields in the LinAlg notes for definitions of addition and scalar multiplication.

\begin{definition}[Displacement vector]
  The vector from the end of $\vec{A}$ to the end of $\vec{B}$ when their starts are in the same location.

  \[
    \longvec{AB} = \vec{B} - \vec{A}
  \]
\end{definition}

\subsection{Dot and cross products}

\begin{definition}[Dot product]
  Where $a, b \in \Real^n$ and $\theta$ is the angle between $a$ and $b$:
  \[
    a \dotp b = \sum a_i b_i = |a| |b| \cos \theta
  \]
\end{definition}

\begin{theorem}[Properties of dot product]
  For $\vec{a}, \vec{b}, \vec{c} \in \Real^n$ and $k \in \Real$:
  \begin{itemize}
    \item $\vec{a} \dotp \vec{a} = |\vec{a}|^2$
    \item $\vec{a} \dotp \vec{a} = 0$ iff $\vec{a} = 0$
    \item Commutativity: $\vec{a} \dotp \vec{b} = \vec{b} \dotp \vec{a}$
    \item Distributivity: $\vec{a} \dotp (\vec{b} + \vec{c}) = \vec{a} \dotp \vec{b} + \vec{a} \dotp \vec{c}$
    \item Distributivity: $(k \vec{a}) \dotp b = k(\vec{a} \dotp \vec{b}) = a \dotp (k \vec{b})$
    \item $\vec{a} \dotp \vec{b} = 0$ iff $a \perp b$, $a = 0$, or $b = 0$.
  \end{itemize}
\end{theorem}

\begin{definition}[Cross product]
  For $\vec{a}, \vec{b} \in \Real^3$, the unique vector $a \crossp b$ satisfying
  \begin{itemize}
    \item $|a \crossp b|$ is the area of the parallelogram spanned by $a$ and $b$
    \item $a \crossp b = 0$ iff $a \parallel b$, $a = 0$, or $b = 0$.
    \item $a \crossp b$ is orthogonal to $a$ and $b$.
    \item $(a, b, a \crossp b)$ is right-handed (if the coordinate system is right-handed)
  \end{itemize}
\end{definition}

\begin{theorem}[Properties of cross product]
  For $a, b, c \in \Real^3$ and $k \in \Real$:
  \begin{itemize}
    \item $a \crossp b = (-b) \crossp a$
    \item $a \crossp (b + c) = a \crossp b + a \crossp c$
    \item $(a + b) \crossp c = a \crossp c + b \crossp c$
    \item $k(a \crossp b) = (ka) \crossp b = a \crossp (kb)$
  \end{itemize}
\end{theorem}

\begin{theorem}[Calculation of cross product]
  Where $a, b \in \Real^n$ and $\theta$ is the angle between $a$ and $b$:
  \begin{align*}
    a \crossp b &= \begin{bmatrix}
      a_2 b_3 - a_3 b_2 \\
      a_3 b_1 - a_1 b_3 \\
      a_1 b_2 - a_2 b_1 \\
    \end{bmatrix} = \begin{vmatrix}
      \ihat & \jhat & \khat \\
      a_1 & a_2 & a_3 \\
      b_1 & b_2 & b_3
    \end{vmatrix} \\
    &= \ihat \begin{vmatrix}
      a_2 & a_3 \\
      b_2 & b_3
    \end{vmatrix}
    + \jhat \begin{vmatrix}
      a_1 & a_3 \\
      b_1 & b_3
    \end{vmatrix}
    + \khat \begin{vmatrix}
      a_1 & a_2 \\
      b_1 & b_2
    \end{vmatrix}
  \end{align*}
  \[
    |a \crossp b| = |a| |b| \sin \theta
  \]
\end{theorem}

\subsection{Lines}

The most useful notation for a line is in parametric form:

\begin{definition}[Parametric form of a line]
  Where $r_0 \in \Real^3$ is a point on the line, and $t \in \Real^3$:
  \[
    r(t) = r_0 + vt
  \]

  $t$ is called the \textbf{direction vector}.
\end{definition}

\begin{theorem}
  Two lines are parallel iff their direction vectors are scalar multiples of each other.
\end{theorem}

\begin{definition}[Skew lines]
  Two lines are skew iff they do not intersect but are not parallel, i.e. they lie in different parallel planes.
\end{definition}

\begin{procedure}[Finding the intersection of two lines]
  Given lines with parametric equations
  \[
    r_1(t) = a_1 + v_1 t \qquad r_2(t) = a_2 + v_2 t
  \]
  solve the system of equations
  \[
    a_1 + v_1 t_1 = a_2 + v_2 t_2
  \]
  for $t_1$ or $t_2$, then plug it in to the appropriate equation.

  (Break up the equation into its $x$, $y$, and $z$ components, or whichever is appropriate for your coordinate space.)
\end{procedure}

\subsection{Planes}

\refresources{Colley [1.5]}

\begin{definition}[Plane]
  A plane $\Pi$ is determined uniquely by a point $P$ in the plane and a normal vector $n$.

  A plane is the set of points $A$ in space such that $\vec{AP}$ is perpendicular to $n$.
\end{definition}

\begin{theorem}[Scalar equation for a plane in $\Real^3$]
  If $n \in \Real^3$ is the \textbf{normal vector} to the plane (vector perpendicular to the plane), and $P \in \Real^3$ is a point on the plane:

  \[
    n_x (x - P_x) + n_y (x - P_y) + n_z (z - P_z) = 0
  \]

  or equivalently:

  \[
    n_x x + n_y y + n_z z = n_x P_x + n_y P_y + n_z P_z
  \]
\end{theorem}

\begin{procedure}[Equation of plane containing three points]
  If $A, B, C \in \Real^3$ are points on our plane, then we can find the normal vector by performing $n = \longvec{AB} \crossp \longvec{AC} = (B - A) \crossp (C - A)$ (since $\longvec{AB}$ and $\longvec{AC}$ are vectors on the plane).
\end{procedure}

\begin{theorem}[Parametric equation for a plane in $\Real^3$]
  If $a, b \in \Real^3$ are nonparallel nonzero vectors on the plane, and $P \in \Real^3$ is a point on the plane, then the parametric equation for the plane is:
  \[
    x(s, t) = P + sa + tb
  \]
\end{theorem}

\subsection{Distance}

\refresources{Colley [1.5]}

\begin{procedure}[Distance between point and line]
  Let $P$ be the point, and $A + Lt$ be the line. Then the distance is
  \[
    |\longvec{AP} - \proj_L \longvec{AP}| = \vec{P}
  \]
\end{procedure}

\begin{procedure}[Distance between parallel planes]
  Let $\Pi_1$ and $\Pi_2$ be the two planes.

  If $n$ is normal to both planes, and $P_1 \in \Pi_1$ and $P_2 \in \Pi_2$, then the answer is
  \[
    |\proj_n \longvec{P_1 P_2}
  \]
\end{procedure}

\subsection{Cylindrical and spherical coordinates}

\refresources{Trimm [5.6, 5.7] Brummet [08, MVCWUP:Feb3(29-33)] \\
Colley [1.7]}

\begin{definition}[Cylindrical coordinate]
  An ordered pair $(r, \theta, z)$ where $r$ is the distance between the point and the $z$-axis, $\theta$ is the angle counterclockwise from the positive $x$-axis along the $xy$-plane, and $z$ is the position on the $z$-axis.
\end{definition}

\begin{definition}[Spherical coordinate]
  An ordered pair $(\rho, \phi, \theta)$, where $\rho$ is the distance between the point and the origin, $\phi$ is the angle clockwise from the positive $z$-axis going downwards towards the $xy$-plane, and $\theta$ is the angle counterclockwise from the positive $x$-axis along the $xy$-plane.

  Typically we use the following restrictions:
  \[
    \rho > 0 \qquad 0 \leq \theta \leq 2\pi \qquad 0 \leq \phi \leq \pi
  \]
\end{definition}

\begin{theorem}[Useful formulas]
  \[
    r = \rho \sin \phi \qquad z = \rho \cos \phi \qquad
  \]\[
    x = \rho \sin \phi \cos \theta \qquad y = \rho \sin \phi \sin \theta
  \]\[
    r^2 = x^2 + y^2 \qquad x = r \cos \theta \qquad y = r \sin \theta
  \]
\end{theorem}

\section{Functions, limits, differentiation}

\subsection{Multivariable functions}

\refresources{Trimm [3.1, 3.2] Brummet [MVCWUP:Feb4(35-41)] Colley [2.1]}

\begin{definition}[Function]
  All functions $f : X \Rightarrow Y$ are defined by:
  \begin{itemize}
    \item A domain set $X$
    \item A codomain set $Y$
    \item A rule of assignment that associates a unique element $y \in Y$ to each element $x \in X$
  \end{itemize}
\end{definition}

\begin{definition}[Graph]
  The graph of $f : X \subseteq \Real^n \Rightarrow \Real$ is the set
  \[
    \{(x_1, \ldots, x_n, f(x)) : x = (x_1, \ldots, x_n)\}
  \]
  Specifically, for $f : \Real^2 \Rightarrow \Real$ the graph is the set
  \[
    \{(x, y, z) : (x, y) \in X \text{ and } z = f(x, y)\}
  \]
\end{definition}

\begin{definition}[Level set]
  Let $f : X \subseteq \Real^n \Rightarrow \Real$. The \textbf{level set at height $c$ of $f$} is the set in $\Real^n$ defined by the equation $f(\vec{a}) = c$, where $c$ is a constant. This is equivalent to the set
  \[
    \{ \vec{x} \in \Real^n : f(\vec{x}) = c \}
  \]

  In $\Real^2$, this is also called a \textbf{level curve}.
\end{definition}

\begin{definition}[Contour set]
  Let $f : X \subseteq \Real^n \Rightarrow \Real$. The \textbf{contour set at height $c$ of $f$} is the set in $\Real^{n + 1}$ defined by the two equations $z = f(\vec{a})$ and $z = c$, where $c$ is a constant. This is equivalent to the set
  \[
    \{ \vec{x} \in \Real^{n + 1} : z = f(\vec{x}) = c \}
  \]

  If $f : X \subseteq Real^2 \Rightarrow \Real$, this is also called a \textbf{contour curve}. It is equivalent to the level curve, except it is located in $\Real^3$ rather than $\Real^2$.
\end{definition}

% TODO: finish this

\subsection{Limits}

\refresources{Trimm [3.3, DiffEq-1.0] Brummet [09, MVCWUP:Feb11(42-46)] \\
Colley [2.2]}

\begin{definition}[Limit]
  $\lim_{\vec{x} \to \vec{a}} f(\vec{x}) = \vec{L}$ if for all $\varepsilon > 0$, there exists $\delta > 0$ s.t. if $0 < |\vec{x} - \vec{a}| < \delta$ then $|f(\vec{a}) - \vec{L}| < \varepsilon$.
\end{definition}

\begin{definition}[Continuity]
  Let $f : X \subseteq \Real^n \Rightarrow \Real^m$ and let $\vec{a} \in X$. Then $f$ is continuous at point $\vec{a}$ iff
  \[
    \lim_{\vec{x} \to \vec{a}} f(\vec{x}) = f(\vec{a})
  \]
  If $f$ is continuous at all $\vec{a} \in X$, then we say that $f$ is continuous.
\end{definition}

\subsection{Differentiation}

\refresources{Trimm [3.4, DiffEq-1.0] \\
Brummet [11, 12.5, MVCWUP:Feb12/22(48-54)] \\
Colley [2.3, 2.4]}

\begin{definition}[Partial derivative with respect to $x$]
  The partial derivative of $f(x, y)$ with respect to $x$ is
  \[
    \lim_{h \to 0} \frac{f(a + h, b) - f(a, b)}{h}
  \]

  Let $z = f(x, y)$. Then the partial derivative is denoted by
  \[
    f_x(x, y) = f_x = \frac{\partial f}{\partial x} = \frac{\partial}{\partial x} f(x, y) = \frac{\partial z}{\partial x} = D_x f
  \]
\end{definition}

\begin{definition}[Partial derivative]
  The partial derivative of $f(\vec{x})$ with respect to the $i$th variable is
  \[
    \frac{\partial f(\vec{x})}{\partial x_i} = \lim_{h \to 0} \frac{f\left(\begin{bmatrix}
      x_0 \\
      \vdots \\
      x_i + h \\
      \vdots \\
      x_n
    \end{bmatrix}\right) - f\left(\vec{x}\right)}{h}
  \]

  This is equivalent to letting $F(x_i) = f(\vec{x})$ and finding $F'(x_i)$.
\end{definition}

\begin{definition}[Higher-order partial]
  The result of taking the partial derivative of a partial derivative, which may be higher-order.

  A partial derivative that is not higher-order is called a \textbf{first-order partial}. A partial derivative of a first-order partial is a second-order partial, a partial derivative of a second-order partial is a third-order partial, etc.

  A higher-order partial which is the result of taking the partial with respect to $x_1$, then with respect to $x_2$, then with respect to $x_3, \ldots, x_n$, is denoted by
  \[
    f_{x_1 \cdots x_n} = \frac{\partial}{\partial x_n} \cdots \frac{\partial}{\partial x_1} f
  \]

  $x_1 \cdots x_n$ do not have to be distinct. If $x_1 \cdots x_n$ are not all the same then the higher-order partial is called a \textbf{mixed partial derivative}.
\end{definition}

\begin{theorem}
  Let $f : X \in \Real^n \Rightarrow \Real$ whose $k$-th order and lower partials exist and are continuous on $X$. Then its $k$-th order and lower partials may be evaluated in any order, i.e.
  \[
    f_{x_1 \cdots x_n} = f_{x_n \cdots x_1} = f_{x_1 x_3 x_{27} \cdots x_4} = \cdots
  \]
\end{theorem}

\begin{definition}[Gradient]
  \[
    \grad f(\vec{x}) = \begin{bmatrix}
      \frac{\partial f(x)}{\partial x_1} \\
      \vdots \\
      \frac{\partial f(x)}{\partial x_n}
    \end{bmatrix}
  \]
\end{definition}

\subsection{Implicit surfaces}

\refresources{Brummet [12]}

\begin{definition}[Implicit surface]
  A surface in $\Real^3$ defined by an equation which is not solved for $x$, $y$, nor $z$.

  We often express it as
  \[
    F(x, y, z) = 0,
  \]
  in which case the surface is the set of points which satisfy $F(x, y, z) = 0$.
\end{definition}

\begin{theorem}
  The gradient $\grad F(\vec{x})$ is the normal vector to the tangent plane to the implicit surface defined by $F(\vec{x}) = k$, where $k$ is a constant.

  Equivalently, if $x_0$ is a point on the level set $S = \{ x \in X : F(x) = k \}$ where $F : X \subseteq \Real^n \Rightarrow \Real$, then the vector $\grad F(x_0)$ is perpendicular to $S$.
\end{theorem}

\subsection{Chain rule}

\refresources{Trimm [3.8, 6.5, DiffEq-1.0] Brummet [12, MVCWUP:Feb24(58-61)] \\
Colley [2.5]}

\begin{definition}[Jacobian]
  If $f: X \subseteq \Real^n \Rightarrow \Real^m$ is a vector-valued function, then the Jacobian is
  \[
    Df\left(\begin{bmatrix}
      x_1 \\
      x_2 \\
      \vdots \\
      x_n
    \end{bmatrix}\right) = \begin{bmatrix}
      \grad f_1 \\
      \grad f_2 \\
      \vdots \\
      \grad f_m
    \end{bmatrix} = \begin{bmatrix}
      \frac{\partial f_1}{\partial x_1} & \frac{\partial f_1}{\partial x_2} & \hdots & \frac{\partial f_1}{x_n} \\
      \frac{\partial f_2}{\partial x_1} & \frac{\partial f_2}{\partial x_2} & \hdots & \frac{\partial f_2}{x_n} \\
      \vdots & \vdots & \ddots & \vdots \\
      \frac{\partial f_m}{\partial x_1} & \frac{\partial f_m}{\partial x_2} & \hdots & \frac{\partial f_m}{x_n} \\
    \end{bmatrix}
  \]
\end{definition}

\begin{theorem}[Multivariable chain rule]
  Suppose $X \subseteq \Real^m$ and $T \subseteq \Real^n$ are open and $f : X \Rightarrow \Real^p$ and
  $r : T \Rightarrow \Real^m$ are defined so that $T \subseteq X$. If $x$ is
  differentiable at $t_0 \in T$ and f is differentiable at $x_0 = r(t_0)$, then
  the composite $f \compose r$ is differentiable at $t_0$, and we have
  \[
    \frac{dF}{dt} = \grad f(x_0) \dotp r'(t_0)
  \]
  Equivalently,
  \[
    D(f \compose r)(t_0) = Df(x_0) Dr(t_0)
  \]

  In $\Real^3$,
  \[
    \frac{dF}{dt} = \frac{\partial F}{\partial x} \frac{dx}{dt} + \frac{\partial F}{\partial y} \frac{dy}{dt} + \frac{\partial F}{\partial z} \frac{dz}{dt}
  \]
\end{theorem}

\subsection{Paths}

\refresources{Brummet [MVCWUP:Feb24(55-56)]}

\begin{definition}[Path]
  A path in $\Real^n$ is a function $x : I \Rightarrow \Real^n$, where $I$ is a set of scalars. If $I = [a, b]$, then the endpoints of the path are $f(a)$ and $f(b)$.
\end{definition}

\begin{definition}[Tangent vector]
  Given a path $r : \Real \Rightarrow \Real^3$, the tangent vector to said path at some point $P$ is given by $r'(t)$, provided that $r'(t) \neq 0$. In $\Real^3$,
  \[
    r'(t) = \lim_{h \to 0} \frac{r(t + h) - r(t)}{h} = \begin{bmatrix}
      \frac{dx}{dt} \\
      \frac{dy}{dt} \\
      \frac{dz}{dt}
    \end{bmatrix}
  \]
\end{definition}

\begin{definition}[Derivative of vector-valued function]
  Let $f : T \subseteq \Real \Rightarrow \Real^m$. Then
  \[
    f'(t) = \begin{bmatrix}
      f_1'(t) \\
      f_2'(t) \\
      \vdots \\
      f_m'(t) \\
    \end{bmatrix}
  \]
\end{definition}

\subsection{Differentiability}

\refresources{Trimm [3.5] 
Brummet [13.5] 
Colley [2.3]}

\begin{definition}[Linear approximation ($\Real^n \Rightarrow \Real$)]
  The \textbf{linear approximation} or \textbf{tangent plane ($\Real^3$) or hyperplane} to the graph of a function $f$ at the point $\vec{a}$ is expressed by
  \[
    L(\vec{x}) = f(\vec{a}) + \grad f(\vec{a}) \dotp (\vec{x} - \vec{a})
  \]

  In $\Real^3$, this is equivalent to the plane
  \[
    z = L(x, y) = f(a, b) + f_x(a, b) (x - a) + f_y(a, b) (y - b)
  \]
\end{definition}

\begin{definition}[Linear approximation ($\Real^n \Rightarrow \Real^m$)]
  The \textbf{linear approximation} to a vector-valued function $f$ at the point $\vec{a}$ is expressed by
  \[
    L(\vec{x}) = f(\vec{a}) + Df(\vec{a})(\vec{x} - \vec{a})
  \]
\end{definition}

\begin{definition}[Differentiability]
  Let $f : X \subseteq \Real^n \Rightarrow \Real^m$, where $X$ is an open subset of $\Real^n$, and let $\vec{a} \in X$. $f$ is differentiable at $a$ iff all of its partial derivatives exist and 
  \[
    \lim_{\vec{x} \to \vec{a}} \frac{f(\vec{x}) - L(\vec{x})}{|\vec{x} - \vec{a}|} = 0
  \]
  where $L(\vec{x})$ is the linear approximation to $f$ at $\vec{a}$
\end{definition}

\begin{theorem}[Differentiability shortcut]
  Let $f : X \subseteq \Real^n \Rightarrow \Real^m$ be a vector-valued function. If all partial derivatives $\frac{\partial f_i}{\partial x_j}$ exist and are continuous in a neighborhood of $\vec{a}$ in $X$, then $F$ is differentiable at $\vec{a}$.
\end{theorem}

\subsection{Directional derivative}

\refresources{Trimm [3.7] 
Brummet [14] 
Colley [2.6]}

\begin{definition}[Directional derivative]
  Let $f : X \subseteq \Real^n \Rightarrow \Real$, where $X$ is an open subset of $\Real^n$, and let $\vec{a} \in X$. If $\vec{v}$ is any unit vector in $X$, then the directional derivative of $f$ at $a$ in the direction of $v$ is
  \[
    D_{\vec{v}} f(\vec{a}) = \lim_{h \to 0} \frac{f(\vec{a} + h\vec{v}) - f(\vec{a})}{h}
  \]
\end{definition}

\begin{theorem}
  If $f$ is differentiable at $a$, then
  \[
    D_{\vec{v}} f(\vec{a}) = \grad f(\vec{a}) \dotp \vec{v}
  \]
\end{theorem}

\begin{theorem}
  The gradient is the path of steepest ascent, i.e.
  \[
    D_{\widehat{\grad f(\vec{a})}} f(\vec{a}) = \max \{ D_{\vec{v}} f(\vec{a}) : \vec{v} \in \Real^n \}
  \]
  where $f : X \subseteq \Real^n \Rightarrow \Real$.
\end{theorem}

\begin{theorem}
  Let $f : X \subseteq \Real^2 \Rightarrow \Real$, and let $(a, b, c) \in \Real^3$. Then $\grad f(a, b)$ is orthogonal to the level curve at height $c$.
\end{theorem}

\section{unit 3}

\subsection{Extrema}

\begin{theorem}
  If $f$ has a local maximum or minimum at $(a, b)$ and the first order partial derivatives exist, then $f_x(a, b) = f_y(a, b) = 0$.
\end{theorem}

\begin{namedtheorem}[Extreme Value Theorem]
  Let $X$ be a closed and bounded subset of $\Real^n$ and suppose $f : X \Rightarrow \Real^n$ is continuous. Then $f$ attains an absolute maximum and an absolute minimum somewhere on $X$.
\end{namedtheorem}

\begin{definition}[Critical point of $f$]
  A point $\vec{c}$ in the domain of $f$ where all of the partial derivatives of $f$ at $\vec{c}$ equal 0.
\end{definition}

\begin{definition}[Saddle point]
  A critical point that is not a max or min.
\end{definition}
